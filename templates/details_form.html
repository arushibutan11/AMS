<!DOCTYPE HTML>
<html>  
<head>
 {% load static %}
<script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.0/jquery.min.js"></script>
<script type="text/javascript" src="{% static 'smart-selects/admin/js/chainedfk.js' %}"></script>
<script type="text/javascript" src="{% static 'smart-selects/admin/js/chainedm2m.js' %}"></script>
<script type="text/javascript" src="{% static 'smart-selects/admin/js/bindfields.js' %}"></script>
<script type="text/javascript" src="{% static 'smart-selects/admin/js/bindfields.js' %}"></script>
<script type = "text/javascript" src="{% static 'fir/js/jquery-3.20.min.js' %}"></script>
<script src="{% static 'fir/js/jquery.formset.js' %}"></script>
<link rel="stylesheet" type="text/css" href="{% static 'fir/css/bootstrap.min.css' %}"/>
<!--<script type="text/javascript" src="http://code.jquery.com/jquery-1.7.1.min.js"></script>-->

<style type="text/css">

label.firsttag {
    width: 84px;
}


label {
    padding-left: 5px;
    padding-right: 5px;
    font-weight: 400;
}
td {
    padding-right: 5px;
}
select {
    width: 180px;
    padding: 3px;
}

div#table2 {
    /*display: none;*/
    
}
div#table1 {
    /*display: none;*/
}

.form-style-6{
    font: 95% Arial, Helvetica, sans-serif;
    margin: 10px auto;
    padding: 16px;
    background: #F7F7F7;
}
.form-style-6 h1{
    background: #2196F3;
    padding: 20px 0;
    font-size: 140%;
    font-weight: 300;
    text-align: center;
    color: #fff;
    margin: -16px -16px 16px -16px;
}
.form-style-6 input[type="submit"],
.form-style-6 input[type="button"]{
    box-sizing: border-box;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    background: #2196F3;
    border-bottom: 2px solid #30C29E;
    border-top-style: none;
    border-right-style: none;
    border-left-style: none;    
    color: #fff;
}
.form-style-6 input[type="text"],
{
    -webkit-transition: all 0.30s ease-in-out;
    -moz-transition: all 0.30s ease-in-out;
    -ms-transition: all 0.30s ease-in-out;
    -o-transition: all 0.30s ease-in-out;
    outline: none;
    box-sizing: border-box;
    -webkit-box-sizing: border-box;
    -moz-box-sizing: border-box;
    background: #fff;
    margin-bottom: 4%;
    border: 1px solid #ccc;
    padding: 3%;
    color: #555;
    font: 95% Arial, Helvetica, sans-serif;
}
div{
    width: 100%;
    border-bottom: 10px;
    border-bottom: 1px #c7bfbf solid;
    color: black;
    /* margin: 10px 0 10px 0; */
    padding: 10px;
} 
input {
    background-color: white
    color: white;
    margin: 5px 0 5px 3px;
    padding: 3px;
}

h2 { text-align: center; }
@import "compass/css3";

.table-editable {
  position: relative;
  
  .glyphicon {
    font-size: 20px;
  }
}

.table-remove {
  color: #700;
  cursor: pointer;
  
  &:hover {
    color: #f00;
  }
}

.table-up, .table-down {
  color: #007;
  cursor: pointer;
  
  &:hover {
    color: #00f;
  }
}

.table-add {
  color: #070;
  cursor: pointer;
  position: absolute;
  right: 0;
  
  &:hover {
    color: #0b0;
  }
}
</style>

</head>
<body>
<div class="form-style-6">
<h1>ACCIDENT REPORT FORM</h1>
<form name="myForm" action=" " method="Post">
{% csrf_token %}
<div>
<label class="firsttag">Accident Id</label>
 {{ form.ACC_ID }} 
 <br>
 <label class="firsttag">Fortnight</label>
{{ form.FN }}

  <label>Month</label>
  {{ form.MONTH }}

  <label>Year</label>
  {{ form.YEAR }}

</div>

<div>

<label class="firsttag">Circle </label> 
{{ form.CIRCLE }}

<label>District</label> 
{{ form.DIST }}

<label>Range </label> 
{{ form.RNG }}

<label>Police Station </label>
{{ form.PS }}

</div>

<div>

<label class="firsttag">FIR No.</label>
{{ form.FIRNO }}

<label>Date </label> 
{{ form.DATE_OCC }}

</div>
<div>

<label class="firsttag">Time </label> 
{{ form.TIME_OCC }}

<label>Time Type </label> 
{{ form.TIME_TYPE }}

<label>Time Slot</label>
<!--<select id="time" name="Time Slot">
    <option value="p1">Approx</option>
    <option value="p2">INFIR</option>
    </select> -->
{{ form.TIME_SLOT }}

<label>Day/Night</label> 
{{ form.DAY_NIGHT }}


</div>
<div>

<label class="firsttag">Location </label> 
{{ form.LOCATION }}
<!--<label> Category</label>-->
{{form.CATEGORY.as_hidden}}

<label>Place of occurance  </label> 
{{ form.PLACE_OCC }}

<label>Intersection  </label> 
{{ form.Intersection}}

<label for="road">Road Name </label> 
{{form.ROAD}}

<br>
<label class="firsttag">Latitude </label> 
{{ form.LATITUDE }}

<label>Longitude </label> 
{{ form.LONGITUDE }}

</div>
<div>

    <label class="firsttag">Section </label> 
{{ form.SECTION }}

  <label>Accident Type</label>
 {{ form.ACCTYPE }}

</div>
<div id="alltables">
<div id="table1" class="table-editable">
    
    <table class="table">
    
      <tr>
        
        <th>Injured- Age</th>
        <th>Injured- Sex</th>
        <th>Injured- Type</th>

      </tr>
      <tr class = "inj-formset">
      {% for i in forminj %}
        <td hidden> {{ i.PS }} </td>
        <td hidden> {{ i.FIRNO }} </td>
        <td hidden> {{ i.YEAR }} </td>
        <td hidden> {{ i.ACCID_ID }} </td>
        <td>{{ i.INJAGE }}</td>
        <td>{{ i.INJSEX }}</td>
        <td>{{ i.INJTYPE }}</td>
      </tr>
      {% endfor %}
</tr>
    </table>
  </div>
  
 <div id="table2" class="table-editable">
    <table class="table">
      <tr>
        <th>Killed- Age</th>
        <th>Killed- Sex</th>
        <th>Killed- Type</th>

      </tr>
      {% for k in formkil %}
      <tr  class = "kil-formset">
        
        <td>{{ k.AGE }}</td>
        <td>{{ k.SEX }}</td>
        <td>{{ k.TYPE }}</td>
      </tr>
      {% endfor %}
      {{ formset.management_form }}
    </table>
  </div>
  </div>
<div>
<h3>Vehicle at fault</h3> 

    <label  class="firsttag">Type</label> 
{{ form.VEHTYPE1 }}


 <label  id="tww1" visible="false">TWW1</label> 
{{ form.TWW1 }}

<br>
    <label class="firsttag" >Registration-No. A</label> 
    {{ form.RNOV1A }}
    <label >Registration-No. B</label> 
    {{ form.RNOV1B }}

    <label id="route" visible="false">Route No.</label> 
    {{ form.routeno }}

</div>
<div>
<h3>Victim Details</h3> 

    <label  class="firsttag">Type </label> 
{{ form.VEHTYPE2 }}
<br>
    <label  class="firsttag" for="regnof">Registration-No. A</label> 
    {{ form.RNOV2A }}
    <label for="regnof">Registration-No. B</label> 
    {{ form.RNOV2B }}

    <label id="Pedestrian" visible="false">Pedestrian</label>
    {{ form.PEDESTRIAN }}

    <!--<label for="board>Boarding/De-boarding</label> -->
    <label id="self_type" visible="false">Self Type</label>
    {{ form.SELF_TYPE }}

</div>
<div>
<h3>Accident Driver Details</h3>


    <label  class="firsttag" >Driver Name</label> 
     {{ form.dri_name }}
     
    <label>Age </label> 
    {{ form.dri_age }}
    
	<label>Sex </label> 
     {{ form.dri_sex }}
    
	
    <label>Address </label> 
     {{ form.dri_add }}
 
 <label>Father's Name </label> 
     {{ form.dri_fath }}
     
    <label class="firsttag">Arrested</label> 
    {{ form.dri_arrest }}

    <label>License No.</label> 
    {{ form.dri_lic_no }}

   

    <label">Place from where License was issued </label> 
    {{ form.dri_place }}
    <label>Drunk/Not Drunk</label> 
    {{ form.ACCDRUNK }}
	<br>
    <label class="firsttag">Issued Date:</label> 
    {{ form.dri_lic_date_issu }}

	<br>
    <label class="firsttag" >Upto Date:</label> 
    {{ form.dri_lic_date_upto }}
    <br>
       <label class="firsttag" >License Status</label> 
    {{ form.dri_lic_status }}

   


</div>
<div>
    <label class="firsttag">Type of Accident</label> 
    {{ form.ACCID_TYPE}}
	
	<label class="firsttag" >Victim</label> 
    {{ form.VICTIM}}
</div>
<div>
    <label class="firsttag" for="remarks">Remarks</label> 
    {{ form.REMARK }}
	
	  <label class="firsttag" for="remarks">Brief Facts</label> 
    {{ form.BRIEF_FACTS }}
	
</div>
<!--
<div>
  <label class="firsttag" for="remarks">Duplicate</label> 
    {{ form.DUPL }}
	
	  <label for="remarks">Pending</label> 
    {{ form.PENDING }}
	
	<br>
	  <label for="remarks">Case Status</label> 
    {{ form.case_status }}
	
	<br>
		
	  <label class="firsttag" >Victim</label> 
    {{ form.VICTIM}}
	
</div> -->
<div>
    

    <label class="firsttag" for="remarks">Convert Case</label> 
    {{ form.CONVERT}}

    <label id="convert_date" visible="false">Convert Date</label>
    {{ form.CONVERT_DATE }}

    <label>Case Status</label>
    {{ form.case_status  }}
	

	
</div>

<input type="submit">
</form>
</div>
<script>

$("#id_CONVERT").change(function () {
    var selection = $("#id_CONVERT option:selected").text();

    if(selection=='TRUE')
    {
        document.getElementById("convert_date").style.visibility="visible";
        $("#id_CONVERT_DATE_month").show();
         $("#id_CONVERT_DATE_day").show();
          $("#id_CONVERT_DATE_year").show();
    }
    else
   {
      document.getElementById("convert_date").style.visibility="hidden";
       $("#id_CONVERT_DATE_month").hide();
       $("#id_CONVERT_DATE_day").hide();
       $("#id_CONVERT_DATE_year").hide();
             
    }});



$("#id_VEHTYPE1").change(function () {
    var selection = $("#id_VEHTYPE1 option:selected").text();
    //alert("you selected" + selection);
    if (selection=='BUS')
    {
    
     document.getElementById("route").style.visibility = "visible";
    $("#id_routeno").show();
    }
    else
    {
        document.getElementById("route").style.visibility = "hidden";
        //$("#id_routeno").attr('disabled', true);
         $("#id_routeno").hide()
      
    }
    if(selection=='TWW')
    {
      document.getElementById("tww1").style.visibility = "visible";
    $("#id_TWW1").show();  
    }
    else
    {
        document.getElementById("tww1").style.visibility = "hidden";
        //$("#id_routeno").attr('disabled', true);
         $("#id_TWW1").hide()
      
    }

    });

$("#id_VEHTYPE2").change(function () {
    var selection = $("#id_VEHTYPE2 option:selected").text();
    //alert("you selected" + selection);
    if (selection=='SELF')
    {
     document.getElementById("self_type").style.visibility = "visible";
    $("#id_SELF_TYPE").show();
    }
    else
    {
        document.getElementById("self_type").style.visibility = "hidden";
        //$("#id_routeno").attr('disabled', true);
         $("#id_SELF_TYPE").hide()
      
    }
     if (selection=='PEDESTRIAN')
    {
     document.getElementById("Pedestrian").style.visibility = "visible";
    $("#id_PEDESTRIAN").show();
    }

    else
    {
        document.getElementById("Pedestrian").style.visibility = "hidden";
        //$("#id_routeno").attr('disabled', true);
         $("#id_PEDESTRIAN").hide()
      
    }


    });





/*CIRCLE*/
$("#id_CIRCLE").change(function () {
    var selection = $("#id_CIRCLE option:selected").text(); //grab the value selected
 
    function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
var csrftoken = getCookie('csrftoken');
function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}
$.ajaxSetup({
    beforeSend: function(xhr, settings) {
        if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
            xhr.setRequestHeader("X-CSRFToken", csrftoken);
        }
    }
});
    $.post({
        url: '/getcircleinfo',
        data: {
          'circle': selection
        },
        dataType: 'json',
        success: function (data) {
            document.getElementById("id_DIST").value = data['DIST'];
            document.getElementById("id_RNG").value = data['RANGE'];
        }
      });
    });

/*SECTION*/   
$("#id_SECTION").change(function () {
    var selection = $("#id_SECTION option:selected").text(); //grab the value selected
 
    function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
var csrftoken = getCookie('csrftoken');
function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}
$.ajaxSetup({
    beforeSend: function(xhr, settings) {
        if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
            xhr.setRequestHeader("X-CSRFToken", csrftoken);
        }
    }
});
    $.post({
        url: '/getsection',
        data: {
          'section': selection
        },
        dataType: 'json',
        success: function (data) {
            document.getElementById("id_ACCTYPE").value = data['ACCTYPE'];
            if (data['ACCTYPE'] == 'S' || data['ACCTYPE'] == 'G' )
            {
                //Show Injured Table
                $("#table2").hide();
                $("#table1").show();
            }
            else if (data['ACCTYPE'] == 'F')
            {   
                $("#table1").show();
                $("#table2").show();
                //Show Killed and Injured Table
            }
            else 
            {
                $("#table1").hide();
                $("#table2").hide(); 
            }

        }
      });
    });

/*LOCATION*/
$("#id_LOCATION").change(function () {
    var selection = $("#id_LOCATION option:selected").text(); //grab the value selected
 
    function getCookie(name) {
    var cookieValue = null;
    if (document.cookie && document.cookie != '') {
        var cookies = document.cookie.split(';');
        for (var i = 0; i < cookies.length; i++) {
            var cookie = jQuery.trim(cookies[i]);
            // Does this cookie string begin with the name we want?
            if (cookie.substring(0, name.length + 1) == (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}
var csrftoken = getCookie('csrftoken');
function csrfSafeMethod(method) {
    // these HTTP methods do not require CSRF protection
    return (/^(GET|HEAD|OPTIONS|TRACE)$/.test(method));
}
$.ajaxSetup({
    beforeSend: function(xhr, settings) {
        if (!csrfSafeMethod(settings.type) && !this.crossDomain) {
            xhr.setRequestHeader("X-CSRFToken", csrftoken);
        }
    }
});
    $.post({
        url: '/getlocation',
        data: {
          'location': selection
        },
        dataType: 'json',
        success: function (data) {
            document.getElementById("id_CATEGORY").value = data['CATEGORY'];
        }
      });
    });

$("#id_DATE_OCC_month").change(function () {
    var selection = $("#id_DATE_OCC_month option:selected").text(); //grab the value selected
    var mon = selection.substring(0, 3);
    document.getElementById("id_MONTH").value = mon;
    });

$("#id_PS, #id_DATE_OCC_year,  #id_FIRNO").change(function () {
    ps =  document.getElementById("id_PS").value
    var psCode = ps.split("-");
    var id = document.getElementById("id_DATE_OCC_year").value +  psCode[1] +  document.getElementById("id_FIRNO").value;
	if(document.getElementById("id_FIRNO").value!="" && document.getElementById("id_PS").value!="" && document.getElementById("id_DATE_OCC_year").value!="")
    { document.getElementById("id_ACC_ID").value = id; }
});

$("#id_DATE_OCC_year").change(function () {
    var selection = $("#id_DATE_OCC_year option:selected").text(); //grab the value selected
    document.getElementById("id_YEAR").value = selection;
    //var id = document.getElementById("id_FIRNO").value + document.getElementById("id_PS").value + document.getElementById("id_DATE_OCC_year").value;
    //document.getElementById("id_ACC_ID").value = id;
    });

	

$("#id_DATE_OCC_day, #id_DATE_OCC_month").change(function () {
    var selection = $("#id_DATE_OCC_day option:selected").text(); 
    var month = $("#id_DATE_OCC_month option:selected").text(); //grab the value selected
    var mon = month.substring(0, 3);
    if(document.getElementById("id_DATE_OCC_month").value!="" && document.getElementById("id_DATE_OCC_day").value!="")
    { 
    	if (selection<=15) 
    	{ document.getElementById("id_FN").value = mon + 1; } 
    	else if (selection>15)
    	{ document.getElementById("id_FN").value = mon + 2; }
}
    });

var $TABLE = $('#table1');
$('.zeroadd').click(function () {
  var $clone = $TABLE.find('tr.hide').clone(true).removeClass('hide table-line');
  $TABLE.find('table').append($clone);
});
//for adding to table2
var $TABLE2 = $('#table2');
$('.oneadd').click(function () {
  var $clone2 = $TABLE2.find('tr.hide').clone(true).removeClass('hide table-line');
  $TABLE2.find('table').append($clone2);
});

$('.inj-formset').formset({
    addText: '<span class="zeroadd table-add glyphicon glyphicon-plus"></span>',
    deleteText: '<span class="glyphicon glyphicon-minus"></span>'    });
$('.kil-formset').formset({
    addText: '<span class="zeroadd table-add glyphicon glyphicon-plus"></span>',
    deleteText: '<span class="glyphicon glyphicon-minus"></span>',
    
    });
	
$("#id_TIME_OCC").change(function () {
    var selection = document.getElementById("id_TIME_OCC").value;
	//for day and night
	if( selection >=0 && selection < 800 ) { document.getElementById("id_DAY_NIGHT").value = "Night"; }
	else if(selection >=800 && selection <= 2400 ) { document.getElementById("id_DAY_NIGHT").value = "Day"; }
	else { document.getElementById("id_DAY_NIGHT").value = "Unknown"; }
	
	//for timeslot
	if( selection >=0 && selection < 0100 ) { document.getElementById("id_TIME_SLOT").value = "0000-0100"; }
	else if(selection >=0100 && selection < 0200 ) { document.getElementById("id_TIME_SLOT").value = "0100-0200"; }
	else if(selection >=0200 && selection < 0300 ) { document.getElementById("id_TIME_SLOT").value = "0200-0300"; }
	else if(selection >=0300 && selection < 0400 ) { document.getElementById("id_TIME_SLOT").value = "0300-0400"; }
	else if(selection >=0400 && selection < 0500 ) { document.getElementById("id_TIME_SLOT").value = "0400-0500"; }
	else if(selection >=0500 && selection < 0600 ) { document.getElementById("id_TIME_SLOT").value = "0500-0600"; }
	else if(selection >=0600 && selection < 0700 ) { document.getElementById("id_TIME_SLOT").value = "0600-0700"; }
	else if(selection >=0700 && selection < 0800 ) { document.getElementById("id_TIME_SLOT").value = "0700-0800"; }
	else if(selection >=0800 && selection < 0900 ) { document.getElementById("id_TIME_SLOT").value = "0800-0900"; }
	else if(selection >=0900 && selection < 1000 ) { document.getElementById("id_TIME_SLOT").value = "0900-1000"; }
	else if(selection >=1000 && selection < 1100 ) { document.getElementById("id_TIME_SLOT").value = "1000-1100"; }
	else if(selection >=1100 && selection < 1200 ) { document.getElementById("id_TIME_SLOT").value = "1100-1200"; }
	else if(selection >=1200 && selection < 1300 ) { document.getElementById("id_TIME_SLOT").value = "1200-1300"; }
	else if(selection >=1300 && selection < 1400 ) { document.getElementById("id_TIME_SLOT").value = "1300-1400"; }
	else if(selection >=1400 && selection < 1500 ) { document.getElementById("id_TIME_SLOT").value = "1400-1500"; }
	else if(selection >=1500 && selection < 1600 ) { document.getElementById("id_TIME_SLOT").value = "1500-1600"; }
	else if(selection >=1600 && selection < 1700 ) { document.getElementById("id_TIME_SLOT").value = "1600-1700"; }
	else if(selection >=1700 && selection < 1800 ) { document.getElementById("id_TIME_SLOT").value = "1700-1800"; }
	else if(selection >=1800 && selection < 1900 ) { document.getElementById("id_TIME_SLOT").value = "1800-1900"; }
	else if(selection >=1900 && selection < 2000 ) { document.getElementById("id_TIME_SLOT").value = "1900-2000"; }
	else if(selection >=2000 && selection < 2100 ) { document.getElementById("id_TIME_SLOT").value = "2000-2100"; }
	else if(selection >=2100 && selection < 2200 ) { document.getElementById("id_TIME_SLOT").value = "2100-2200"; }
	else if(selection >=2200 && selection < 2300 ) { document.getElementById("id_TIME_SLOT").value = "2200-2300"; }
	else if(selection >=2300 && selection < 2400 ) { document.getElementById("id_TIME_SLOT").value = "2300-2400"; }
	else { document.getElementById("id_TIME_SLOT").value = "UNK.-TIME"; }




     });
</script>
</body>
</html>





